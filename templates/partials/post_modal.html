<div class="post-left">
    {% if user.is_authenticated and user == post.author %}
        <div class="options-menu" data-post-id="{{ post.id }}">
            <button class="options-btn">‚ãÆ</button>
            <div class="dropdown">
                <a href="{% url 'post_update' post.id %}">–ò–∑–º–µ–Ω–∏—Ç—å –ø–æ—Å—Ç</a>
                <button class="del-post-btn" data-post-id="{{ post.id }}">
                    –£–¥–∞–ª–∏—Ç—å –ø–æ—Å—Ç
                </button>
            </div>
        </div>
    {% endif %}

    {% if post.original_post %}
        <p style="color:green;">
            <a href="{% url 'profile' post.author.id %}">üîÅ {{ post.author.username }}</a>
            —Å–¥–µ–ª–∞–ª —Ä–µ–ø–æ—Å—Ç
        </p>
        {% with orig=post.original_post %}
            <div class="repost-box" style="border:1px solid #ccc; padding:10px; border-radius:10px;">
                <span class="online-dot" data-user-id="{{ orig.author.id }}"></span>
                <p>
                    <img src="{{ orig.author.avatar.url }}" class="round" style="width:40px;height:40px;">
                </p>
                <h3>
                    <a href="{% url 'profile' orig.author.id %}">üîÅ {{ orig.author.username }}</a>
                </h3>
                <p>{{ orig.content }}</p>
                <small>{{ orig.created_at }}</small>
                {% for img in orig.images.all %}
                    <img src="{{ img.image.url }}" style="max-width:200px; border-radius:10px; margin-top:10px;">
                {% endfor %}
            </div>
        {% endwith %}

    {% else %}
        <br>
        <span class="online-dot" data-user-id="{{ post.author.id }}"></span>
        <p><img src="{{ post.author.avatar.url }}" alt="–ê–≤–∞—Ç–∞—Ä" class="round"></p>
        <h3>
            <a href="{% url 'profile' post.author.id %}">{{ post.author.username }}</a>
        </h3>
        <p>{{ post.content }}</p>
        <small>{{ post.created_at }}</small>
        {% for img in post.images.all %}
            <img src="{{ img.image.url }}" style="max-width:200px; border-radius:10px; margin-top:10px;">
        {% endfor %}
    {% endif %}

    <hr>

    {% if user.is_authenticated %}
        <button class="modal-like-btn" data-post-id="{{ post.id }}">
            {% if post.is_liked %}
                <i class="fa-solid fa-heart" style="color:red;"></i>
            {% else %}
                <i class="fa-regular fa-heart"></i>
            {% endif %}
        </button>
    {% else %}
        <i class="fa-regular fa-heart"></i>
    {% endif %}

    <span id="modal-like-count">{{ post.likes.count }}</span>

    <i class="fa-regular fa-comment"></i>
    <span id="modal-comment-count">{{ post.comments.count }}</span>

    {% if user.is_authenticated %}
        <button class="modal-repost-btn" data-post-id="{{ post.id }}">
            <i class="fa-solid fa-retweet"></i>
        </button>
    {% else %}
        <i class="fa-solid fa-retweet"></i>
    {% endif %}

    <span id="modal-repost-count-{{ post.id }}">{{ post.reposts.count }}</span>

    {% if user.is_authenticated %}
        <button class="sendPost-btn" data-post-id="{{ post.id }}">
            <i class="fa-regular fa-share-from-square"></i>
        </button>
    {% endif %}
</div>

<div class="post-right">
    <h3>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</h3>
    {% if user.is_authenticated %}
        <textarea id="modal-comment-text-{{ post.id }}" rows="2"></textarea>
        <button class="modal-comment-btn" data-post-id="{{ post.id }}">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
    {% endif %}

    <div class="modal-sort-container" style="margin-bottom:15px;">
        <select class="modal-sort-selector" data-post-id="{{ post.id }}">
            <option value="modal-date-new">–ü–æ –¥–∞—Ç–µ (—Å–Ω–∞—á–∞–ª–∞ –Ω–æ–≤—ã–µ)</option>
            <option value="modal-date-old">–ü–æ –¥–∞—Ç–µ (—Å–Ω–∞—á–∞–ª–∞ —Å—Ç–∞—Ä—ã–µ)</option>
            <option value="modal-likes">–ü–æ –ª–∞–π–∫–∞–º</option>
        </select>
    </div>

    <div id="comment-list-{{ post.id }}" class="comments" data-post-id="{{ post.id }}">
        <ul id="modal-comments-list-{{ post.id }}">
            {% for comment in comments %}
                <li id="modal-comment-{{ comment.id }}">
                    <strong>
                        <a href="{% url 'profile' comment.user.id %}">{{ comment.user.username }}</a>
                    </strong>:
                    <span class="comment-text">{{ comment.text }}</span>
                    <small class="text-muted"> {{ comment.created_at }} </small>
                    {% if user.is_authenticated %}
                        <button class="modal-comment-like-btn" data-comment-id="{{ comment.id }}">
                            {% if comment.is_liked %}
                                <i class="fa-solid fa-heart" style="color:red;"></i>
                            {% else %}
                                <i class="fa-regular fa-heart"></i>
                            {% endif %}
                        </button>
                    {% else %}
                        <i class="fa-regular fa-heart"></i>
                    {% endif %}

                    <span id="modal-actual-comment-like-{{ comment.id }}">
                        {{ comment.comment_likes.count }}
                    </span>

                    {% if user.is_authenticated and user == comment.user %}
                        <button class="modal-del-comment-btn" data-comment-id="{{ comment.id }}">–£–¥–∞–ª–∏—Ç—å</button>
                    {% endif %}

                    {% if user.is_authenticated and user == comment.user %}
                        <a href="{% url 'update_comment' comment.id %}" class="edit-comment-btn" data-comment-id="{{ comment.id }}">
                            –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                        </a>
                    {% endif %}
                </li>
            {% endfor %}
        </ul>
    </div>
</div>
